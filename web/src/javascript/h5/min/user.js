function navInit(){nav_view.init(),nav_event.init()}function toParamMap(e){var n={},t=e.split("&");for(var a in t){var o=t[a],r=o.indexOf("=");if(!(r<0)){var c=o.substring(0,r),s=o.substring(r+1);n[c]=s}}return n}function openImplict(e){var n=document.createElement("script");n.src=e,document.body.appendChild(n)}function callback(e){var n=e.openid,t="/user/index_apis/qqloginoauth",a=base.cache.get_cookie("access_token");$.ajax({type:"POST",url:t,data:{access_token:a,openid:n,sessionid:base.cache.get_cookie("nsessid"),type:1},dataType:"json",success:function(e){200==e.code&&(window.location.href=base.cache.get_cookie("initurl"))}})}function getQueryString(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(n);return null!=t?unescape(t[2]):null}function checkUidToken(){return""!=base.cache.get_cookie("uid")&&""!=base.cache.get_cookie("token")}var base={manageapi:"http://h5.veryside.com",redirect_host:"http://www.veryside.com/",qqAppId:"101384575",wxAppId:"wx7fbd27a1f8706423",wbClientId:"3945175064",cache:{get_domain:function(){var e=window.location.host.match(/([^\.]+).(com|net|me|org)/);return null!=e?e[1]:null},set_cookie:function(e,n,t){var a=this,o=new Date;o.setTime(o.getTime()+2592e6),document.cookie=e+"="+encodeURIComponent(n)+"; domain=."+a.get_domain()+".com; path=/; expires="+o.toGMTString()},get_cookie:function(e){var n=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return n?decodeURIComponent(n[1]):null},clear_cookie:function(e){return this.set_cookie(e,"")}},tools:{getQueryString:function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(n);return null!=t?unescape(t[2]):null},rand:function(e){for(var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t="",a=0;a<e;a++){var o=Math.ceil(35*Math.random());t+=n[o]}return t}}},$search_btn,$search_box,$search_input,$search_plaholder,$search_close,$nav_SearchTmpl,$login_out,$nav,nav_view={init:function(){this.initPlaceholder()},initPlaceholder:function(){var e=document.createElement("input"),n="placeholder"in e;n||($search_plaholder.css("display","block"),$search_plaholder.on("click",function(e){$search_input.focus()}),$search_input.on({focus:function(){"block"==$search_plaholder.css("display")?$search_plaholder.hide():""},blur:function(){""==$(this).val()?$search_plaholder.css("display","block"):$search_plaholder.css("display","none")}}))}},nav_event={init:function(){$search_btn.on("click",this.clickSearchBtn),$search_close.on("click",this.closeSearchBox),$search_input.on("keyup",this.searching),$search_input.on("keydown",this.disDefault),$nav_SearchTmpl.on("mouseenter","span",this.beColor),$nav_SearchTmpl.on("click","span",this.clickSearchTmpl),$("body").on("click",this.hideSearchTmpl),$search_input.on("focus",this.showSearchTmpl),$nav.children("div").each(function(e,n){$(n).on("mouseenter",nav_event.mouseoverNavList),$(n).on("mouseleave",nav_event.mouseleaveNavList)}),$login_out.on("click",this.logout)},clickSearchBtn:function(e){e=e||window.event,e.preventDefault(),$search_box.show(),$search_box.find("input").focus(),$search_box.find(".searchWord").animate({width:"390px"},500)},closeSearchBox:function(){$search_box.find(".searchWord").animate({width:"0"},500,function(){$search_box.hide()}),$nav_SearchTmpl.children().length>0?$nav_SearchTmpl.empty():"",""!=$search_input.val()?$search_input.val(""):""},searching:function(e){$nav_SearchTmpl.show(),e=e||window.event;var n=""==$(this).val()||/^ +$/.test($(this).val())?0:1,t=$nav_SearchTmpl.find("span").length;if(13==e.keyCode&&n){var a=$nav_SearchTmpl.find("span.hasColor");a.length>0?($(this).val(a.html()),window.open("/search/?keyword="+a.html()+"&exact=1")):window.open("/search/?keyword="+$(this).val()+"&exact=0")}else if(38==e.keyCode&&n&&t){var a=$nav_SearchTmpl.find("span.hasColor");if(a.length>0){var o=a.prev();o.length>0?(a.removeClass("hasColor"),o.addClass("hasColor")):(a.removeClass("hasColor"),$nav_SearchTmpl.find("span").last().addClass("hasColor"))}else $nav_SearchTmpl.find("span").last().addClass("hasColor")}else if(40==e.keyCode&&n&&t){var a=$nav_SearchTmpl.find("span.hasColor");if(a.length>0){var r=a.next();r.length>0?(a.removeClass("hasColor"),r.addClass("hasColor")):(a.removeClass("hasColor"),$nav_SearchTmpl.find("span").first().addClass("hasColor"))}else $nav_SearchTmpl.find("span").first().addClass("hasColor")}else if(n){var c="/search/index_apis/searchkeywords",s={keyword:$(this).val()},i=function(e){var n=e.length;if(n>0){var t=$nav_SearchTmpl.attr("temId"),a=$("#"+t).html(),o=doT.template(a);$nav_SearchTmpl.html(o(e))}else $nav_SearchTmpl.html("")};$.get(c,s,i,"json")}else $nav_SearchTmpl.html("")},disDefault:function(e){e=e||window.event,38==e.keyCode||40==e.keyCode?e.preventDefault():""},beColor:function(){$(this).siblings().removeClass("hasColor"),$(this).addClass("hasColor")},clickSearchTmpl:function(){$search_input.val($(this).text()),window.open("/search/?keyword="+$(this).text()+"&exact=1")},hideSearchTmpl:function(e){e=e||window.event;var n=$(e.target);0==n.parents(".search-box").length&&$nav_SearchTmpl.children().length>0&&"block"==$nav_SearchTmpl.css("display")&&$nav_SearchTmpl.hide()},showSearchTmpl:function(){$nav_SearchTmpl.children().length>0&&"none"==$nav_SearchTmpl.css("display")&&$nav_SearchTmpl.show()},mouseoverNavList:function(){$(this).siblings().each(function(e,n){$(this).find("ul").stop(!0,!0).hide()}),$(this).find("ul").show(600)},mouseleaveNavList:function(){$(this).find("ul").hide()},logout:function(){base.cache.clear_cookie("token"),base.cache.clear_cookie("uid"),base.cache.clear_cookie("nsessid"),base.cache.clear_cookie("lgtype"),nav_event.getQueryString("url")&&null!=nav_event.getQueryString("url")?window.location.href=nav_event.getQueryString("url"):window.location.reload()},getQueryString:function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(n);return null!=t?unescape(t[2]):null}};$(document).ready(function(){$search_btn=$(".search"),$search_box=$(".search-box"),$search_input=$search_box.find("input"),$search_close=$(".search-close"),$nav_SearchTmpl=$(".nav-search-tmpl"),$search_plaholder=$(".placeholder"),$nav=$(".top-menu-box .nav"),$login_out=$("#logout"),navInit()}),function(){"use strict";function e(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(n,function(n){return e[n]||n}):this}}function n(e,t,a){return("string"==typeof t?t:t.toString()).replace(e.define||c,function(n,t,o,r){return 0===t.indexOf("def.")&&(t=t.substring(4)),t in a||(":"===o?(e.defineParams&&r.replace(e.defineParams,function(e,n,o){a[t]={arg:n,text:o}}),t in a||(a[t]=r)):new Function("def","def['"+t+"']="+r)(a)),""}).replace(e.use||c,function(t,o){e.useParams&&(o=o.replace(e.useParams,function(e,n,t,o){if(a[t]&&a[t].arg&&o){var r=(t+":"+o).replace(/'|\\/g,"_");return a.__exp=a.__exp||{},a.__exp[r]=a[t].text.replace(new RegExp("(^|[^\\w$])"+a[t].arg+"([^\\w$])","g"),"$1"+o+"$2"),n+"def.__exp['"+r+"']"}}));var r=new Function("def","return "+o)(a);return r?n(e,r,a):r})}function t(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var a,o={version:"1.0.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:void 0,compile:void 0};"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):(a=function(){return this||(0,eval)("this")}(),a.doT=o),String.prototype.encodeHTML=e();var r={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},c=/$^/;o.template=function(a,s,i){s=s||o.templateSettings;var l,u,d=s.append?r.append:r.split,h=0,p=s.use||s.define?n(s,a,i||{}):a;p=("var out='"+(s.strip?p.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):p).replace(s.interpolate||c,function(e,n){return d.start+t(n)+d.end}).replace(s.encode||c,function(e,n){return l=!0,d.start+t(n)+d.endencode}).replace(s.conditional||c,function(e,n,a){return n?a?"';}else if("+t(a)+"){out+='":"';}else{out+='":a?"';if("+t(a)+"){out+='":"';}out+='"}).replace(s.iterate||c,function(e,n,a,o){return n?(h+=1,u=o||"i"+h,n=t(n),"';var arr"+h+"="+n+";if(arr"+h+"){var "+a+","+u+"=-1,l"+h+"=arr"+h+".length-1;while("+u+"<l"+h+"){"+a+"=arr"+h+"["+u+"+=1];out+='"):"';} } out+='"}).replace(s.evaluate||c,function(e,n){return"';"+t(n)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),l&&s.selfcontained&&(p="String.prototype.encodeHTML=("+e.toString()+"());"+p);try{return new Function(s.varname,p)}catch(f){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+p),f}},o.compile=function(e,n){return o.template(e,null,n)}}(),$(document).ready(function(){var e=base.qqAppId,n="",t=window.location.href;base.tools.getQueryString("url")&&(t=base.tools.getQueryString("url"));var a=encodeURIComponent(base.redirect_host+"user/thirdtransfer/");if(0==window.location.hash.length||"return-top-flag"==window.location.hash.substring(1)){var o="https://graph.qq.com/oauth2.0/authorize?",r=["client_id="+e,"redirect_uri="+a,"scope=get_user_info,list_album,upload_pic,add_feeds,do_like","response_type=token"],c=r.join("&");n=o+c,2!=base.cache.get_cookie("lgtype")&&3!=base.cache.get_cookie("lgtype")&&base.cache.set_cookie("initurl",t,5)}else{var s=window.location.hash.substring(1),i=toParamMap(s);base.cache.set_cookie("access_token",i.access_token,5);var o="https://graph.qq.com/oauth2.0/me?",r=["access_token="+i.access_token,"callback=callback"],c=r.join("&"),l=o+c;openImplict(l)}$("#qq_login").on("click",function(){window.location.href=n})}),$(document).ready(function(){var e=base.wxAppId,n=window.location.href.replace("#return-top-flag","");base.tools.getQueryString("url")&&(n=base.tools.getQueryString("url")),$("#wx_login").on("click",function(){base.cache.set_cookie("lgtype",2,5),base.cache.set_cookie("initurl",n,5),base.cache.get_cookie("initurl")&&(window.location.href="https://open.weixin.qq.com/connect/qrconnect?appid="+e+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_login&state="+base.tools.rand(10))})}),$(document).ready(function(){var e=base.wbClientId,n=window.location.href.replace("#return-top-flag","");base.tools.getQueryString("url")&&(n=base.tools.getQueryString("url")),$("#wb_login").on("click",function(){base.cache.set_cookie("lgtype",3,5),base.cache.set_cookie("initurl",n,5),window.location.href="https://api.weibo.com/oauth2/authorize?client_id="+e+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&forcelogin=true&state="+base.tools.rand(10)})}),$(document).ready(function(){function e(e){a({url:"/user/index_apis/getusermsg",data:{uid:e.data.uid,token:e.data.token},success:function(e){n(e),t()}})}function n(e){base.cache.set_cookie("user_msg",e,15)}function t(){var e=window.location.href;/user\/?$/.test(e)?window.location.href="/":base.tools.getQueryString("url")?window.location.href=base.tools.getQueryString("url"):window.location.reload()}function a(e){$.ajax({type:e.type||"GET",url:e.url,data:e.data,dataType:"json",success:e.success})}var o=$("#getVerCode"),r=$("#phone_login_btn"),c=$("#phone_num"),s=$("#code_num"),i=$("#user_agreement"),l=$("#err_msg_box"),u=$("#vercode-num"),d=$("#vercode-pic");o.on("click",function(){if(!/^1[3|4|5|6|7|8|9]\d{9}$/.test(c.val()))return l.text("请输入/更正手机号码！"),c.addClass("warning-border").focus(),!1;if("none"==d.parent().css("display"))d.parent().show(),d.click(),u.val("").focus(),c.attr("disabled",!0).css("cursor","not-allowed"),s.attr("disabled",!0).css("cursor","not-allowed");else if(/^[0-9]{1,2}$/.test(u.val())){var e=$(this);l.text(""),a({url:"/captcha/index_apis/getcode",data:{phone:c.val(),code:u.val()},success:function(n){if("200"==n.code){c.attr("disabled",!0).css("cursor","not-allowed"),s.attr("disabled",!1).css("cursor","text").focus(),u.attr("disabled",!0).css("cursor","not-allowed"),u.parent().hide();var t=60,a=setInterval(function(){t--,t>0?e.val(t+"s"):(clearInterval(a),e.val("获取动态码").removeAttr("disabled style"),c.attr("disabled",!1).css("cursor","text"),u.attr("disabled",!1).css("cursor","text"))},1e3);e.attr("disabled",!0).css("cursor","not-allowed")}else l.text(n.msg),u.val("").focus(),d.click()}})}else l.text("请输入/更正验证码！"),u.focus()}),c.on("blur",function(){c.removeClass("warning-border")}),r.on("click",function(){/^1[3456789]\d{9}$/.test(c.val())?/^\d{4}$/.test(s.val())?"checked"!=i.attr("checked")?l.text("请同意用户协议！"):a({url:"/user/index_apis/phonelogin",data:{phone:c.val(),vcode:s.val()},success:function(n){200==n.code?e(n):l.html(n.msg)}}):(l.text("请输入/更正动态码！"),s.focus()):(l.text("请输入/更正手机号码！"),c.focus())}),i.on("click",function(){$(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked")}),d.on("click",function(){$(this).get(0).src="/captcha?"+(new Date).getTime()})});