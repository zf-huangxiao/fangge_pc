function navInit(){nav_view.init(),nav_event.init()}function getQueryString(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(n);return null!=a?unescape(a[2]):null}function checkUidToken(){return""!=base.cache.get_cookie("uid")&&""!=base.cache.get_cookie("token")}var base={manageapi:"http://h5.veryside.com",redirect_host:"http://www.veryside.com/",qqAppId:"101384575",wxAppId:"wx7fbd27a1f8706423",wbClientId:"3945175064",cache:{get_domain:function(){var e=window.location.host.match(/([^\.]+).(com|net|me|org)/);return null!=e?e[1]:null},set_cookie:function(e,n,a){var o=this,c=new Date;c.setTime(c.getTime()+2592e6),document.cookie=e+"="+encodeURIComponent(n)+"; domain=."+o.get_domain()+".com; path=/; expires="+c.toGMTString()},get_cookie:function(e){var n=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return n?decodeURIComponent(n[1]):null},clear_cookie:function(e){return this.set_cookie(e,"")}},tools:{getQueryString:function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(n);return null!=a?unescape(a[2]):null},rand:function(e){for(var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a="",o=0;o<e;o++){var c=Math.ceil(35*Math.random());a+=n[c]}return a}}},$search_btn,$search_box,$search_input,$search_plaholder,$search_close,$nav_SearchTmpl,$login_out,$nav,nav_view={init:function(){this.initPlaceholder()},initPlaceholder:function(){var e=document.createElement("input"),n="placeholder"in e;n||($search_plaholder.css("display","block"),$search_plaholder.on("click",function(e){$search_input.focus()}),$search_input.on({focus:function(){"block"==$search_plaholder.css("display")?$search_plaholder.hide():""},blur:function(){""==$(this).val()?$search_plaholder.css("display","block"):$search_plaholder.css("display","none")}}))}},nav_event={init:function(){$search_btn.on("click",this.clickSearchBtn),$search_close.on("click",this.closeSearchBox),$search_input.on("keyup",this.searching),$search_input.on("keydown",this.disDefault),$nav_SearchTmpl.on("mouseenter","span",this.beColor),$nav_SearchTmpl.on("click","span",this.clickSearchTmpl),$("body").on("click",this.hideSearchTmpl),$search_input.on("focus",this.showSearchTmpl),$nav.children("div").each(function(e,n){$(n).on("mouseenter",nav_event.mouseoverNavList),$(n).on("mouseleave",nav_event.mouseleaveNavList)}),$login_out.on("click",this.logout)},clickSearchBtn:function(e){e=e||window.event,e.preventDefault(),$search_box.show(),$search_box.find("input").focus(),$search_box.find(".searchWord").animate({width:"390px"},500)},closeSearchBox:function(){$search_box.find(".searchWord").animate({width:"0"},500,function(){$search_box.hide()}),$nav_SearchTmpl.children().length>0?$nav_SearchTmpl.empty():"",""!=$search_input.val()?$search_input.val(""):""},searching:function(e){$nav_SearchTmpl.show(),e=e||window.event;var n=""==$(this).val()||/^ +$/.test($(this).val())?0:1,a=$nav_SearchTmpl.find("span").length;if(13==e.keyCode&&n){var o=$nav_SearchTmpl.find("span.hasColor");o.length>0?($(this).val(o.html()),window.open("/search/?keyword="+o.html()+"&exact=1")):window.open("/search/?keyword="+$(this).val()+"&exact=0")}else if(38==e.keyCode&&n&&a){var o=$nav_SearchTmpl.find("span.hasColor");if(o.length>0){var c=o.prev();c.length>0?(o.removeClass("hasColor"),c.addClass("hasColor")):(o.removeClass("hasColor"),$nav_SearchTmpl.find("span").last().addClass("hasColor"))}else $nav_SearchTmpl.find("span").last().addClass("hasColor")}else if(40==e.keyCode&&n&&a){var o=$nav_SearchTmpl.find("span.hasColor");if(o.length>0){var t=o.next();t.length>0?(o.removeClass("hasColor"),t.addClass("hasColor")):(o.removeClass("hasColor"),$nav_SearchTmpl.find("span").first().addClass("hasColor"))}else $nav_SearchTmpl.find("span").first().addClass("hasColor")}else if(n){var s="/search/index_apis/searchkeywords",i={keyword:$(this).val()},r=function(e){var n=e.length;if(n>0){var a=$nav_SearchTmpl.attr("temId"),o=$("#"+a).html(),c=doT.template(o);$nav_SearchTmpl.html(c(e))}else $nav_SearchTmpl.html("")};$.get(s,i,r,"json")}else $nav_SearchTmpl.html("")},disDefault:function(e){e=e||window.event,38==e.keyCode||40==e.keyCode?e.preventDefault():""},beColor:function(){$(this).siblings().removeClass("hasColor"),$(this).addClass("hasColor")},clickSearchTmpl:function(){$search_input.val($(this).text()),window.open("/search/?keyword="+$(this).text()+"&exact=1")},hideSearchTmpl:function(e){e=e||window.event;var n=$(e.target);0==n.parents(".search-box").length&&$nav_SearchTmpl.children().length>0&&"block"==$nav_SearchTmpl.css("display")&&$nav_SearchTmpl.hide()},showSearchTmpl:function(){$nav_SearchTmpl.children().length>0&&"none"==$nav_SearchTmpl.css("display")&&$nav_SearchTmpl.show()},mouseoverNavList:function(){$(this).siblings().each(function(e,n){$(this).find("ul").stop(!0,!0).hide()}),$(this).find("ul").show(600)},mouseleaveNavList:function(){$(this).find("ul").hide()},logout:function(){base.cache.clear_cookie("token"),base.cache.clear_cookie("uid"),base.cache.clear_cookie("nsessid"),base.cache.clear_cookie("lgtype"),nav_event.getQueryString("url")&&null!=nav_event.getQueryString("url")?window.location.href=nav_event.getQueryString("url"):window.location.reload()},getQueryString:function(e){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(n);return null!=a?unescape(a[2]):null}};$(document).ready(function(){$search_btn=$(".search"),$search_box=$(".search-box"),$search_input=$search_box.find("input"),$search_close=$(".search-close"),$nav_SearchTmpl=$(".nav-search-tmpl"),$search_plaholder=$(".placeholder"),$nav=$(".top-menu-box .nav"),$login_out=$("#logout"),navInit()}),$(document).ready(function(){var e=getQueryString("code");e&&null!=e&&2==base.cache.get_cookie("lgtype")&&checkUidToken()&&$.ajax({type:"POST",url:"/user/index_apis/wxloginoauth",data:{code:e,sessionid:base.cache.get_cookie("nsessid")},dataType:"json",success:function(e){200==e.code&&(window.location.href=base.cache.get_cookie("initurl"))}})});